+++
title = 'CORS Examples'
date = 2024-07-22T00:20:22+09:00
draft = true
+++


ğŸŸ¢ ì´ë¯¸ì§€ê²€ìƒ‰ CORS ë¬¸ì œ ğŸŸ¢ 
í™•ì¥í”„ë¡œê·¸ë¨ì´ iframeìœ¼ë¡œ ë“¤ì–´ê°€ê³  - ìŠ¤í¬ë¦½íŠ¸
ìµìŠ¤í…ì…˜ ì‹ë³„ìì˜ ì–´ëŠ ìœ„ì¹˜ì— ë“¤ì–´ê°€ëŠ”ê±´ë°. 
ì´ê²½ìš° /extensionì´ë¼ í†µê³¼ê°€ ë˜ëŠ”ë°

ë„¤ì´ë²„ ì´ë¯¸ì§€ëŠ” ë”°ë¡œ iframeì´ ì•„ë‹ˆë¼ì„œ
originì´ ë„¤ì´ë²„,1688 ì´ë ‡ê²Œ ë¨.
-> 
ì´ë¯¸ì§€ í‚¤ ë°›ëŠ”ê²Œ content scriptì—ì„œ ë³´ë‚´ê³ ìˆìŒ.
ë°˜ë©´ iframeì€ í¬ë¡¬ìµìŠ¤í…ì…˜ ë‚´ë¶€ íŒŒì¼ì„ ì—¬ëŠ”ê±°ë¼ í¬ê²Œ ë¬¸ì œ ì—†ëŠ”ë°.

ì´ì œ content script jsì—ì„œ ì„œë¹„ìŠ¤ì›Œì»¤ì— ìš”ì²­í•˜ê³  ê±°ê¸°ì„œ fetchë¡œ ë³´ë‚´ë©´ ëŒ€ì²´ë¡œ í•´ê²°ë ë“¯.
ì„œë¹„ìŠ¤ì›Œì»¤ëŠ” originì„ ë”±íˆ ê°–ê³ ìˆì§€ ì•Šì„ê±°ë¼.

ìœˆë„ìš°ì—ì„œ ê°ì ë‚˜ê°ˆë•Œ vs ë°±ê·¸ë¼ìš´ë“œì—ì„œ ë‚˜ê°ˆë•Œ ì°¨ì´ ìˆìŒ.
ë°±ê·¸ë¼ìš´ë“œë¡œ í†µì¼í•˜ë©´ ì–´ë–¨ê¹Œ.
ì „ìì—ì„  axiosì¸ë° í›„ìì´ë©´ ê·¸ê²Œ ì•ˆë¼ì„œ fetchë¡œë§Œ ë‚˜ê°€ê³ .
ê°™ì€ API ìš”ì²­ì¸ë° ë‘ë²ˆ ì‘ì„±í•˜ê³¤ í–ˆì—ˆìŒ.


---
ì´ë¯¸ì§€ê²€ìƒ‰ CORS ë­ê°€ ë¬¸ì œì˜€ì„ê¹Œ?
- ìµìŠ¤í…ì…˜ -> ì•Œë¦¬ë°”ë°” -> itemscout ì´ë¯¸ì§€ POST ìš”ì²­ì¸ë°
ì•Œë¦¬ë°”ë°”ì—ì„œ ì•„ìŠ¤ë¡œ ìš”ì²­í•˜ë ¤ë©´ originì„ ì•„ìŠ¤ë¡œ ë°”ê¿”ì•¼í•˜ëŠ” ìƒí™©.
ê·¸ëŸ¬ë ¤ë©´ ìµìŠ¤í…ì…˜ manifest permissionì— ì•Œë¦¬ë°”ë°”ë¥¼ ì¶”ê°€í•´ì•¼í•¨.

*
manifest.jsonì˜ permissionsì— ë„ë©”ì¸ì„ ëª…ì‹œì ìœ¼ë¡œ ì„ ì–¸í•˜ëŠ” ê²ƒì€
- ìµìŠ¤í…ì…˜ì´ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ë„ë©”ì¸ì„ ëª…í™•íˆ ì œí•œ
- ì‚¬ìš©ìê°€ ìµìŠ¤í…ì…˜ ì„¤ì¹˜ ì‹œ ì–´ë–¤ ë„ë©”ì¸ì— ì ‘ê·¼í•˜ëŠ”ì§€ í™•ì¸ ê°€ëŠ¥
- ë¬´ë¶„ë³„í•œ ì™¸ë¶€ ì ‘ê·¼ì„ ë°©ì§€í•˜ëŠ” ê²ƒ.

* origin ì„¤ì •
CORSëŠ” ë‹¤ë¥¸ ë„ë©”ì¸ì—ì„œ ì˜¤ëŠ” ìš”ì²­ì— ëŒ€í•´ ì ìš©ë©ë‹ˆë‹¤. ë§Œì•½ ìš”ì²­ì´ ê°™ì€ ë„ë©”ì¸ì—ì„œ ë°œìƒí•œë‹¤ë©´ CORSê°€ ì ìš©ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ originì´ ì°íˆì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

app.use((req, res, next) => {
    if (whitelistPaths.some(path => req.path.startsWith(path))) {
        whitelistCors(req, res, next);
    } else {
        defaultCors(req, res, next);
    }
});

ğŸ’ í´ë¼ì—ì„œ í•´ì•¼í•¨. 