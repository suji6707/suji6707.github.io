+++
series = ['컴퓨터 밑바닥의 비밀']
tags = ['컴파일', 'CS']
title = '컴퓨터 밑바닥의 비밀 - 4장. 트랜지스터에서 CPU로'
date = 2024-05-07T00:20:22+09:00
# draft = true
+++
## 4장. 트랜지스터에서 CPU로

### 4.1 CPU라는 작은 장난감
#### 트랜지스터
- 소프트웨어가 수행하는 기능은 최종적으로 트랜지스터의 간단한 개폐 작업으로 완성됨

#### 논리곱, 논리합, 논리부정
트랜지스터라는 스위치로 세 가지 회로를 만들어볼 수 있음
1. 스위치 두 개가 동시에 켜질 때만 전류가 흐른다: 논리곱
2. 하나라도 켜져있으면 전류가 흐른다: 논리합
3. 스위치를 닫으면 전류가 흐른다: 논리부정

이 세 가지 게이트만 있으면 어떤 논리 함수도 구현 가능.

회로는 1비트를 저장할 수 있는데,
이를 조합한 회로를 '레지스터'라고 함.

연산 논리를 CPU로 구현
- CPU 명령어 집합 체계
- ex) 명령어 | R2, R6 레지스터를 연산해서 | R6에 저장한다

클럭 신호(Clock signal)
- CPU에서 지휘자 역할
- 클럭 신호가 전압을 변경할 때마다 전체 회로의 각 레지스터, 즉 전체 회로 상태가 갱신됨.

CPU의 클럭 주파수(Clock rate)
- 1초 동안 파동 주기가 몇 번 발생하는가
- 클럭 주파수가 높을 수록 1초에 더 많은 작업을 할 수 있다

CPU(processor)는 산술논리 장치, 정보를 저장할 수 있는 레지스터, 작업을 함께 하도록 제어하는 클럭 신호의 조합.


---
### 4.2 CPU는 유휴 상태일 때 무엇을 할까

프로세스 관리와 스케줄링은 운영체제의 핵심 기능

대기열 상태 확인
- 운영체제는 대기열을 사용하여 프로세스를 관리.

컴퓨터 시스템의 모든 것은 최종적으로 CPU로 구동.
- halt 명령어는 CPU 내부의 일부 모듈을 절전 상태로 전환

유휴 프로세스와 CPU의 저전력 상태
- 커널은 유휴 시간을 예측하고 어떤 수면상태로 진입할지 결정

인터럽트
- 타이머 인터럽트를 일정 시간마다 생성하고 CPU는 그 신호를 감지
- 운영체제는 어떤 프로세스가 실행될지 판단해서 스케줄링


---
### 4.3 CPU는 숫자를 어떻게 인식할까
부호있는 정수

부호-크기 표현의 반전: 1의 보수

컴퓨터 친화적 표현 방식: 2의 보수
- 가산기가 계산을 수행할 때 숫자 부호에 신경 쓸 필요가 없다는 장점
- 사람에게는 직관적이지 않지만 CPU 회로 설계를 단순화할 수 있음.

CPU는 숫자가 양수인지 음수인지 전혀 신경쓰지 않고 연산함

---
### 4.4 CPU가 if문을 만났을 때

배열요소가 정렬된 상태와 정렬되지 않은 상태의 
프로그램 실행상태 차이가 매우 큼.

#### 파이프라인 기술의 탄생
CPU 자체를 하나의 메가팩토리로 볼 수 있는데,
CPU가 하나의 기계 명령어를 실행하기 위해 대체로 4가지 과정을 거침.
- instruction fetch
- instruction decode
- execute
- writeback

if문은 컴파일러가 조건부 점프 명령어로 변환.
분기 점프 명령어가 완료되기 전에 다음 명령어가 이미 파이프라인에 들어가있어야 하는데,
어떤 분기를 넣을지 알지 못하므로 예측을 해야 함.

배열이 정렬되어 있으면 if 조건의 결과는 매우 규칙적인데 
정렬되어있지 않으면 분기 예측 실패율이 높아져 프로그램 성능이 떨어짐.