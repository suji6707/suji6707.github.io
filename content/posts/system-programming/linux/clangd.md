+++
title = 'Debugger'
date = 2025-01-12T00:20:22+09:00
draft = true
+++
# C 디버깅 with Clangd

Clangd and the C++ Extension will fight over intellisense / code completion as they both try to do the same task at the same time. You need to disable intellisense for the C++ Extension by adding the following line to your settings.json file:

"C_Cpp.intelliSenseEngine": "disabled",

이걸로는 안돼서 아래와 같이
익스텐션 환경에 따라 .json 다르게 설정함.

참고로 clangd 확장을 사용하면 Microsoft C/C++ 확장(C_Cpp)의 설정들이 무시되고,
clangd 자체 포매팅 설정해야.
.clang-format
```
BasedOnStyle: Google
IndentWidth: 4
BreakBeforeBraces: Attach
ColumnLimit: 0
```

🟢 clangd 설치만으로 디버깅 환경이 바뀐 이유:
VSCode가 clangd를 기본 언어 서버로 사용하도록 설정되었기 때문일 것.
그 전에는 Microsoft IntelliSense (기본)이 적용.
clangd 언어 서버는 LLVM 프로젝트 일부, 업계 표준 컴파일러(clang) 기반.

언어 서버(Language Server)는 코드 편집기에 다음과 같은 기능들을 제공하는 프로그램입니다:

주요 기능:
1. 코드 자동 완성 (Auto-completion)
2. 문법 오류 검사 (Syntax checking)
3. 정의로 이동 (Go to definition)
4. 참조 찾기 (Find references)
5. 코드 포매팅 (Code formatting)

장점:
- 여러 에디터에서 재사용 가능
- 언어별로 표준화된 기능 제공
- 에디터와 언어 기능을 분리

예시:
```c
int main() {
    pri    // 여기서 자동완성 제안
}
```
↓ 언어 서버가 제안
```
printf
private
print
...
```

즉, 언어 서버는 코드를 이해하고 분석하여 개발자에게 지능적인 코딩 지원을 제공하는 백엔드 서비스라고 볼 수 있습니다.

## brew install llvm
brew install llvm으로 설치한 것은 LLVM 전체 툴체인을 설치한 것입니다. 여기에는 여러 도구들이 포함되어 있습니다:

주요 구성요소:
1. clang (컴파일러)
2. clangd (언어 서버)
3. lldb (디버거)
4. 기타 LLVM 도구들

즉:
- llvm은 전체 패키지
- clangd는 그 중 언어 서버 부분
- clang은 실제 컴파일러
- lldb는 디버거

설치된 위치 확인:
```bash
# LLVM 도구들의 위치
/usr/local/opt/llvm/bin/
# 또는
/opt/homebrew/opt/llvm/bin/

# 각 도구 확인
ls /usr/local/opt/llvm/bin/
```

---
## launch.json, tasks.json
// clangd의 경우
```json
{
  // Use IntelliSense to learn about possible attributes.
  // Hover to view descriptions of existing attributes.
  // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
  "version": "0.2.0",
  "configurations": [
    {
      "name": "(lldb) Launch",
      "type": "lldb", // 🔴 llvm 디버거
      "request": "launch",
      "program": "${fileDirname}/${fileBasenameNoExtension}",
      "args": [],
      "stopAtEntry": false,
      "cwd": "${fileDirname}",
      "environment": [],
      "externalConsole": false,
      "MIMode": "lldb",
      "preLaunchTask": "(lldb) Launch" // 🔴
    }
  ]
}
// tasks.json
{
  "tasks": [
    {
      "type": "shell", // 🔴 cppbuild, llvm도 아님.
      "label": "(lldb) Launch",
      "command": "/usr/bin/clang", // 🔴 clang 펌파일러로 실행, 코드편집기에선 clangd 언어서버 적용
      "args": [
        "-fcolor-diagnostics",
        "-fansi-escape-codes",
        "-g",
        "${file}",
        "-o",
        "${fileDirname}/${fileBasenameNoExtension}"
      ],
      "options": {
        "cwd": "${fileDirname}"
      },
      "problemMatcher": ["$gcc"],
      "group": {
        "kind": "build",
        "isDefault": true
      },
      "detail": "Task generated by Debugger."
    }
  ],
  "version": "2.0.0"
}

```

2. c/c++ 익스텐션의 경우
```json
{
  // Use IntelliSense to learn about possible attributes.
  // Hover to view descriptions of existing attributes.
  // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
  "version": "0.2.0",
  "configurations": [
    {
      "name": "(lldb) Launch",
      "type": "cppbuild", // 🔴
      "request": "launch",
      "program": "${fileDirname}/${fileBasenameNoExtension}",
      "args": [],
      "stopAtEntry": false,
      "cwd": "${fileDirname}",
      "environment": [],
      "externalConsole": false,
      "MIMode": "lldb",
      "preLaunchTask": "(lldb) Launch"
    }
  ]
}
// tasks.json
// {
  "tasks": [
    {
      "type": "cppbuild", // 🔴
      "label": "(lldb) Launch",
      "command": "/usr/bin/clang",
      "args": [
        "-fcolor-diagnostics",
        "-fansi-escape-codes",
        "-g",
        "${file}",
        "-o",
        "${fileDirname}/${fileBasenameNoExtension}"
      ],
      "options": {
        "cwd": "${fileDirname}"
      },
      "problemMatcher": ["$gcc"],
      "group": {
        "kind": "build",
        "isDefault": true
      },
      "detail": "Task generated by Debugger."
    }
  ],
  "version": "2.0.0"
}

```
