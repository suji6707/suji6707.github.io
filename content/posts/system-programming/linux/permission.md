+++
title = 'Ubuntu 설정'
date = 2024-12-08T00:20:22+09:00
draft = true
+++
## 파일 읽기쓰기 권한

---
### 도커 설치
공식문서대로 설치 후 (ap-get install)
```
sudo chown root:docker /var/run/docker.sock
sudo usermod -a -G docker ubuntu
grep docker /etc/group
sudo chmod 660 /var/run/docker.sock
```
-> 그룹에 4 + 2 (read, write) 권한을 줌.

---
### 방화벽

sudo iptables -nL
sudo iptables -I INPUT -p tcp -m tcp --dport 8080 -j ACCEPT

- `-I INPUT`: INPUT 체인의 시작에 규칙 추가
- `-p tcp`: TCP 프로토콜
- `--dport 8080`: 목적지 포트 8080
- `-j ACCEPT`: 해당 트래픽 허용

sudo chmod 750 /var/run/docker.sock 로는 아래와같이 바뀌었는데 여전히 접근할 수 없었고
`srwxr-x---  1 root docker    0 Dec  7 12:43 docker.sock=`
반면 chmod 666 으로 했더니 아래로 바뀌면서 접근이 가능해졌어
`srw-rw-rw-  1 root docker    0 Dec  7 12:43 docker.sock=`
750, 666 무슨차이? 그리고 권한이 어떻게 바뀐거지?

`chmod` 명령어를 사용하여 파일이나 디렉토리의 권한을 변경할 때, 각 숫자는 소유자, 그룹, 그리고 기타 사용자에 대한 권한을 나타냅니다. `750`과 `666`의 차이를 이해하기 위해 각 숫자가 의미하는 바를 설명하겠습니다.

### 권한 숫자의 의미:

- **숫자 7**: 읽기(r), 쓰기(w), 실행(x) 권한 모두를 의미합니다. (4 + 2 + 1 = 7)
- **숫자 6**: 읽기(r)와 쓰기(w) 권한을 의미합니다. (4 + 2 = 6)
- **숫자 5**: 읽기(r)와 실행(x) 권한을 의미합니다. (4 + 1 = 5)
- **숫자 0**: 권한이 없음을 의미합니다.

### `chmod 750`의 의미:

- **소유자(root)**: `rwx` (읽기, 쓰기, 실행 권한)
- **그룹(docker)**: `r-x` (읽기, 실행 권한)
- **기타 사용자**: `---` (권한 없음)

이 설정에서는 그룹에 속한 사용자들이 읽기와 실행 권한만 가지고 있으며, 쓰기 권한이 없기 때문에 Docker 소켓에 쓰기 접근을 할 수 없습니다.

### `chmod 666`의 의미:

- **소유자(root)**: `rw-` (읽기, 쓰기 권한)
- **그룹(docker)**: `rw-` (읽기, 쓰기 권한)
- **기타 사용자**: `rw-` (읽기, 쓰기 권한)

이 설정에서는 모든 사용자(소유자, 그룹, 기타 사용자)가 읽기와 쓰기 권한을 가지고 있습니다. 이로 인해 모든 사용자가 Docker 소켓에 접근할 수 있게 됩니다.

### 권한 변경의 결과:

- `srwxr-x---`: 이 설정에서는 그룹에 속한 사용자들이 Docker 소켓에 쓰기 접근을 할 수 없기 때문에, Docker 명령을 실행할 수 없습니다.
- `srw-rw-rw-`: 이 설정에서는 모든 사용자에게 쓰기 권한이 부여되어 Docker 소켓에 접근할 수 있게 됩니다.

**보안 고려사항**: `chmod 666`으로 설정하면 모든 사용자에게 Docker 소켓에 대한 쓰기 권한을 부여하게 되어 보안상 위험할 수 있습니다. Docker 소켓에 대한 무제한 접근은 시스템의 보안에 심각한 위협이 될 수 있으므로, 가능한 한 특정 사용자나 그룹에게만 필요한 권한을 부여하는 것이 좋습니다. `docker` 그룹에 사용자를 추가하고, 소켓 파일의 그룹 권한을 적절히 설정하는 것이 더 안전한 방법입니다.

---

디렉토리의 권한을 나타내는 `drwx------`는 특정 사용자와 그룹에 대한 읽기, 쓰기, 실행 권한을 설명합니다. 이 경우, `docker/` 디렉토리의 권한을 해석해보면 다음과 같습니다:

- **`d`**: 이 문자는 해당 항목이 디렉토리임을 나타냅니다.
- **`rwx------`**: 이 부분은 권한을 세 부분으로 나누어 설명합니다:
  - **`rwx` (소유자 권한)**: 디렉토리의 소유자(root)는 읽기(r), 쓰기(w), 실행(x) 권한을 모두 가지고 있습니다.
    - **읽기(r)**: 디렉토리 내의 파일 목록을 볼 수 있습니다.
    - **쓰기(w)**: 디렉토리 내에 파일을 생성, 삭제, 이름 변경 등을 할 수 있습니다.
    - **실행(x)**: 디렉토리에 접근할 수 있습니다(디렉토리 내의 파일을 열거나 실행할 수 있음).
  - **`---` (그룹 권한)**: 디렉토리의 그룹(root)에 속한 사용자는 아무 권한도 없습니다.
  - **`---` (기타 사용자 권한)**: 시스템의 다른 모든 사용자도 아무 권한도 없습니다.

따라서, `drwx------` 권한 설정은 디렉토리의 소유자인 `root` 사용자만이 해당 디렉토리에 대한 모든 권한을 가지며, 다른 사용자나 그룹은 접근할 수 없음을 의미합니다.

---

