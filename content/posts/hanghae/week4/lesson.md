+++
title = 'week4 강의 필기'
date = 2025-07-07T00:20:22+09:00
draft = true
+++

WEEK 4 강의

정규화
- summary 테이블에서 반정규화 적용.
너무 과한 정규화(JOIN 지옥)와 과한 반정규화(중복 업데이트) 사이. 

과제
- queue producer는 infra 레이어에 두고
컨슈머만 별도 워커 폴더에 두는건가?

외부 시스템: 애플리케이션 외의. db, 큐, 파일시스템, 외부 API 등.
유스케이스에 대한 통합 테스트.

> redis: createClient -> 에 대해 connect


🟢🟢🟢🟢🟢🟢 (회사 코드) 읽기/쓰기 db 나누는 이유? 🟢🟢🟢🟢🟢🟢
어떤 상황 때문에 CQRS가 나왔는가-가 있을뿐, CQRS를 위해 읽기/쓰기 db를 분리하는 게 아님.

읽기 트래픽이 많고 join이 많은?
-> 정확히는 비즈니스 유스케이스의 차이임.
- 결제/회원가입 후 조회 이런것들은 몇 ms가 크리티컬해서 master로 처리하고,
반면 데이터분석- 여러 테이블의 데이터를 조합하고 계산해서 통계/분석 정보를 제공하는 쿼리의 경우 SLAVE로.
연산이 비교적 많아 쿼리시간이 길기도 하고, 이럴때 락이 걸리면 안되니까. 
데이터웨어하우스의 이러한 집계성 쿼리는 따로 워커를 두고 돌리기도 하는것처럼.
- 무식하게 read는 slave, write는 master 나누는게 아니라
정말로 slave여야 하는 부분에만 slave db로 쿼리하는거임.

- typeorm save는 masterdb 업데이트값을 반환하지만
불가피하게 직접 save 후 반환해야 하는 경우 
master로 쿼리하도록 명시해야함.
- 데코레이터 or 명확한 함수 분리.

